import{_ as G}from"./BMNtZN_2.js";import{_ as y}from"./CUVYuoQp.js";import{d as w,P as U,i as B,o as F,w as a,a as A,e as t,t as u,f as d,m as T,u as i,p as P,q as I,af as J,N as K,c as E,F as L,_ as O,s as Q,l as W,n as X,A as Y}from"./8QiH33WF.js";import{u as C}from"./B8ynWgUJ.js";import{_ as Z}from"./CebZ4Rg0.js";import{_ as tt}from"./DsNnbL9Z.js";import{t as q,o as H,s as M,_ as j}from"./Cr4JGMLb.js";import{_ as at}from"./DSEaCN0s.js";import{u as V}from"./q1OLa3wU.js";import{u as x}from"./DygIN5F_.js";import{_ as et}from"./D0LHb9o-.js";import{_ as nt,a as ot,b as st,c as it,d as ct,e as rt}from"./Oq0BLpzs.js";import"./DYeM7O8W.js";import"./DtzL8dFM.js";import"./fpd_cD3O.js";import"./x0I6OrRB.js";import"./5QQhv1ND.js";import"./C3AzuWgF.js";import"./e2K_0ChY.js";import"./Brao1_R0.js";import"./BJlwRGmy.js";import"./B_pj9KdJ.js";const lt={class:"flex items-center gap-4"},mt={class:"flex-1"},ut=w({__name:"SaasUserAvatarForm",setup(D){const{toast:e}=U(),{t:o}=C(),r=()=>{e({variant:"success",title:o("settings.notifications.avatarUpdated")})},s=()=>{e({variant:"error",title:o("settings.notifications.avatarNotUpdated")})};return(l,p)=>{const _=G,m=y;return F(),B(m,null,{title:a(()=>[d(u(l.$t("settings.account.avatar.title")),1)]),default:a(()=>[A("div",lt,[A("div",mt,[A("p",null,u(l.$t("settings.account.avatar.description")),1)]),t(_,{onSuccess:r,onError:s})])]),_:1})}}}),_t=w({__name:"SaasChangeNameForm",setup(D){var v;const{t:e}=C(),{apiCaller:o}=V(),{toast:r}=U(),{user:s,reloadUser:l}=x(),p=q(H({name:M().min(3)})),{handleSubmit:_,isSubmitting:m,meta:c,resetForm:n}=T({validationSchema:p,initialValues:{name:((v=s.value)==null?void 0:v.name)||""}}),h=_(async f=>{var g;try{await o.auth.update.mutate({name:f.name}),r({variant:"success",title:e("settings.notifications.nameUpdated")}),await l(),n({values:{name:((g=s.value)==null?void 0:g.name)||""}})}catch{r({variant:"error",title:e("settings.notifications.nameUpdateFailed")})}});return(f,g)=>{const S=Z,b=tt,N=at,k=j,$=I,R=y;return F(),B(R,{onSubmit:i(h),isSubmitting:i(m),isSubmitDisabled:!i(c).dirty||!i(c).valid},{title:a(()=>[d(u(f.$t("settings.account.changeName.title")),1)]),default:a(()=>[t($,{name:"name"},{default:a(({componentField:z})=>[t(k,null,{default:a(()=>[t(b,null,{default:a(()=>[t(S,P(z,{autocomplete:"name"}),null,16)]),_:2},1024),t(N)]),_:2},1024)]),_:1})]),_:1},8,["onSubmit","isSubmitting","isSubmitDisabled"])}}}),pt=w({__name:"SaasChangePasswordForm",setup(D){const{t:e}=C(),{apiCaller:o}=V(),{toast:r}=U(),s=q(H({password:M().min(8)})),{handleSubmit:l,isSubmitting:p,setFieldValue:_,meta:m}=T({validationSchema:s,initialValues:{password:""}}),c=l(async n=>{try{await o.auth.changePassword.mutate({password:n.password}),_("password",""),r({variant:"success",title:e("settings.notifications.passwordUpdated")})}catch{r({variant:"error",title:e("settings.notifications.passwordNotUpdated")})}});return(n,h)=>{const v=et,f=j,g=I,S=y;return F(),B(S,{onSubmit:i(c),isSubmitting:i(p),isSubmitDisabled:!i(m).valid||!i(m).dirty},{title:a(()=>[d(u(n.$t("settings.account.changePassword.title")),1)]),default:a(()=>[A("div",null,[t(g,{name:"password"},{default:a(({componentField:b})=>[t(f,null,{default:a(()=>[t(v,P(b,{type:"password",id:b.name,required:"",autocomplete:"new-password"}),null,16,["id"])]),_:2},1024)]),_:1})])]),_:1},8,["onSubmit","isSubmitting","isSubmitDisabled"])}}}),dt=w({__name:"SaasDeleteAccountForm",setup(D){const{t:e}=C(),{toast:o}=U(),r=J(),s=K(!1),{apiCaller:l}=V(),{mutate:p,status:_}=l.auth.deleteAccount.useMutation(),m=async()=>{try{await p(),o({variant:"success",title:e("settings.notifications.accountDeleted")}),r.replace("/")}catch{o({variant:"error",title:e("settings.notifications.accountNotDeleted")})}};return(c,n)=>{const h=y,v=it,f=ct,g=st,S=O,b=rt,N=ot,k=nt;return F(),E(L,null,[t(h,{danger:"",onSubmit:n[0]||(n[0]=$=>s.value=!0),"submit-label":i(e)("settings.account.deleteAccount.submit")},{title:a(()=>[d(u(c.$t("settings.account.deleteAccount.title")),1)]),default:a(()=>[A("p",null,u(c.$t("settings.account.deleteAccount.description")),1)]),_:1},8,["submit-label"]),t(k,{open:i(s),"onUpdate:open":n[3]||(n[3]=$=>s.value=$)},{default:a(()=>[t(N,null,{default:a(()=>[t(g,null,{default:a(()=>[t(v,{class:"text-destructive"},{default:a(()=>[d(u(c.$t("settings.account.deleteAccount.title")),1)]),_:1}),t(f,null,{default:a(()=>[d(u(c.$t("settings.account.deleteAccount.confirmation")),1)]),_:1})]),_:1}),t(b,null,{default:a(()=>[t(S,{variant:"outline",onClick:n[1]||(n[1]=$=>s.value=!1)},{default:a(()=>[d(u(c.$t("common.confirmation.cancel")),1)]),_:1}),t(S,{variant:"error",loading:i(_)==="pending",onClick:n[2]||(n[2]=$=>{m(),s.value=!1})},{default:a(()=>[d(u(c.$t("settings.account.deleteAccount.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["open"])],64)}}}),ft={key:0,class:"grid gap-6"},Ht=w({__name:"general",setup(D){const{t:e}=C(),{user:o}=x();return Q({title:e("settings.account.title")}),W(()=>{o.value||Y("/auth/login")}),(r,s)=>{const l=ut,p=_t,_=pt,m=dt;return i(o)?(F(),E("div",ft,[t(l),t(p,{initialValue:i(o).name||""},null,8,["initialValue"]),t(_),t(m)])):X("",!0)}}});export{Ht as default};
