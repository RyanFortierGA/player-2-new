import{c as G}from"./BJlwRGmy.js";import{_ as J}from"./BGJzcXPY.js";import{_ as K}from"./BET4E6RN.js";import{u as W,T as X,_ as Y}from"./CChrxTUx.js";import{_ as Z}from"./DsNnbL9Z.js";import{t as ee,o as te,s as $,a as oe,_ as ae}from"./Cr4JGMLb.js";import{_ as re}from"./C73mHSXW.js";import{_ as ne}from"./CebZ4Rg0.js";import{d as S,j as w,k as se,l as ie,m as ce,c as me,o as i,a as _,i as d,n as F,t as r,u as o,e as t,w as a,f,p as ue,q as le,_ as pe,r as _e,s as fe}from"./8QiH33WF.js";import{u as de}from"./q1OLa3wU.js";import{u as T}from"./B8ynWgUJ.js";import{u as he}from"./DygIN5F_.js";import{u as s}from"./DYdusctJ.js";import"./C3AzuWgF.js";import"./Brao1_R0.js";import"./B_pj9KdJ.js";const ye={class:"text-3xl font-bold"},ve={class:"text-muted-foreground mb-6 mt-2"},be=S({__name:"SaasOtpForm.client",setup(C){const{apiCaller:c}=de(),{t:h}=T(),{user:m,loaded:u}=he(),x=se(),O=ee(te({root:$().optional(),code:$().min(6).max(6)})),{searchQuery:l}=s({name:"invitationCode",replace:!0}),{searchQuery:E}=s({name:"redirectTo",replace:!0}),{searchQuery:k}=s({name:"identifier",replace:!0}),{searchQuery:A}=s({name:"type",replace:!0}),B=w(()=>A.value),Q=w(()=>l.value?`/team/invitation?code=${l.value}`:E.value||x.public.auth.redirectPath),y=()=>{typeof window>"u"||(window.location.href=Q.value)};ie(()=>{var e;m.value&&u.value&&((e=m.value.teamMemberships)!=null&&e.length?y():window.location.href="/onboarding")});const{zodErrorMap:V,setApiErrorsToForm:I}=W();oe(V);const v=ce({validationSchema:O,initialValues:{code:""}}),{handleSubmit:M,isSubmitting:N,errors:b}=v,g=M(async e=>{try{await c.auth.verifyOtp.mutate({code:e.code,type:B.value,identifier:k.value}),y()}catch(n){I(n,v,{defaultError:h("auth.verifyOtp.hints.verificationFailed")})}});return(e,n)=>{const P=J,R=Y,j=K,q=re,z=ne,D=Z,H=ae,L=le,U=pe;return i(),me("div",null,[_("h1",ye,r(e.$t("auth.verifyOtp.title")),1),_("p",ve,r(e.$t("auth.verifyOtp.message")),1),o(l)?(i(),d(P,{key:0,class:"mb-6"})):F("",!0),_("form",{onSubmit:n[0]||(n[0]=_e((...p)=>o(g)&&o(g)(...p),["prevent"])),class:"flex flex-col items-stretch gap-6"},[o(b).root?(i(),d(j,{key:0,variant:"error"},{default:a(()=>[t(o(X),{class:"size-6"}),t(R,null,{default:a(()=>[f(r(o(b).root),1)]),_:1})]),_:1})):F("",!0),t(L,{name:"code"},{default:a(({componentField:p})=>[t(H,null,{default:a(()=>[t(q,{for:"code",required:""},{default:a(()=>[f(r(e.$t("auth.verifyOtp.otp")),1)]),_:1}),t(D,null,{default:a(()=>[t(z,ue(p,{type:"text",autocomplete:"one-time-code"}),null,16)]),_:2},1024)]),_:2},1024)]),_:1}),t(U,{loading:o(N),type:"submit"},{default:a(()=>[f(r(e.$t("auth.verifyOtp.submit"))+" â†’ ",1)]),_:1},8,["loading"])],32)])}}}),ge=G(be),Ne=S({__name:"otp",setup(C){const{t:c}=T();return fe({title:c("auth.verifyOtp.title")}),(h,m)=>{const u=ge;return i(),d(u)}}});export{Ne as default};
