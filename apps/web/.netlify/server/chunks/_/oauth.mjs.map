{"version":3,"file":"oauth.mjs","sources":["../../../../../../packages/auth/lib/oauth.ts"],"sourcesContent":null,"names":["db","sessionToken","sessionCookie"],"mappings":"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"}